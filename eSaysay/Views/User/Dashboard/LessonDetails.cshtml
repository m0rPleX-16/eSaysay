@model List<eSaysay.Models.Entities.InteractiveExercise>
@{
    var lesson = ViewBag.Lesson as eSaysay.Models.Entities.Lesson;
    ViewData["Title"] = $"{lesson.Title} - Exercises";
}

<div class="lesson-details-container">
    <h2 class="lesson-title">@lesson.Title</h2>
    <p class="lesson-description">@lesson.Description</p>

    @if (Model.Count == 0)
    {
        <p class="text-muted">No exercises available for this lesson.</p>
    }
    else
    {
        <div class="carousel-wrapper">
            <button class="carousel-control prev" onclick="moveSlide(-1)">&#10094;</button>
            <div class="carousel">
                <div class="exercise-list">
                    @foreach (var exercise in Model)
                    {
                        <div class="exercise-card">
                            <h3 class="exercise-type">@exercise.ExerciseType</h3>
                            <p class="exercise-content">@exercise.Content</p>
                            <a asp-controller="Dashboard" asp-action="StartExercise" asp-route-exerciseId="@exercise.ExerciseID" class="btn btn-start">Start Exercise</a>
                        </div>
                    }
                </div>
            </div>
            <button class="carousel-control next" onclick="moveSlide(1)">&#10095;</button>
        </div>
    }

    <a asp-controller="Dashboard" asp-action="Index" class="btn btn-back">Back to Lessons</a>
</div>


<script>
    let currentIndex = 0;
    function moveSlide(step) {
        const slides = document.querySelectorAll('.exercise-card');
        const totalSlides = slides.length;
        const container = document.querySelector('.carousel');
        const cardWidth = slides[0].offsetWidth + 30; // Includes margin
        currentIndex = (currentIndex + step + totalSlides) % totalSlides;
        container.style.transform = `translateX(-${currentIndex * cardWidth}px)`;
    }
</script>